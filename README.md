# PyBer Analysis Report

|      Type         |             Name                |             Description            | 
--------------------|---------------------------------|------------------------------------|
| Program Language  | Python 3.7.7                    |                                    |
| APIs and Modules  | Anaconda 4.8.3                  |                                    |
|                   | Pandas 1.0.3                    |                                    |
|                   | Matplotlib 3.1.3                |                                    |
| Data Sources      | resources/city_data.csv         |                                    |
|                   | resources/ride_data.csv         |                                    |
| Programming Tools | Jupyter Notebook                |                                    |
| Application Files | PyBer_Analysis.ipynb            | PyBer ride share data analysis     |

## Background and Results

### Purpose

The purpose of this project is to analyze ride data from the cities that PyBer has, so far, provided it's ride-sharing services in and to generate market analysis data aggregated by the type of city where each ride took place in. Each city where a PyBer ride took place is assigned one of the following city types:

* Urban
* Suburban
* Rural

PyBer management will use this market analysis data to improve access to ride sharing services and to determine affordability for underserved neighborhoods.

### Technical Analysis

This analysis utilized PyBer ride-sharing data for the months of January to April of 2019. The ride sharing data for this period consisted of two data sets:

Ride Data
* Date of the ride
* City where the ride occured
* Total fare
* Ride Id - unique ride identifier

City Data
* City name
* City type
* Number of PyBer drivers

The application to generate this analysis data was created using Jupyter Notebook, Python, Python Pandas API, and Matplotlib API

The Jupyter Notebook application generated the following analysis data:

Ride Summary Data Table
* Total Rides
* Total Drivers
* Total Fares
* Average Fare 
* Average Fare per Driver

The ride summary data was generated by reading the city data and ride data files in to Panda DataFrames and using Pandas .merge() method to merge the two data set data frames.

`pyber_data_df = pd.merge(ride_data_df, city_data_df, how="left", on=["City", "City"])`

Total Weekly Fares By City Type Line Chart

The following steps were used to generate this line chart.

The date information from the ride data was initially imported as strings. The string object containing date information had to be converted to Panda datetime objects

`ride_data_df['Date'] = pd.to_datetime(ride_data_df['Date'])`

Then the data frame index was set to the date field

`pyber_data_df = pyber_data_df.set_index("Date")`

The Pandas DataFrame was then converted into a pivot table

`per_day_type_total_fare_pt = pd.pivot_table(per_day_type_total_fare_df, values='Fare', index=['Date'],  columns=['City Type'])`

Then the pivot table was resampled to aggregate the fare values in the pivot table by week

`per_day_type_total_fare_pt = per_day_type_total_fare_pt.resample("w")`

The chart was generated using the Pandas pivot table object plot() method and using the object oriented interface to Matplotlab plot API

```

ax = per_week_city_type_total_fare_pt.plot(figsize=(14,4),  fontsize=font_size)
 
ax.grid(True)
ax.set_xlabel("", fontsize=font_size)
ax.set_ylabel("Fares ($USD)", fontsize=font_size)
ax.set_title("Total Fare by City Type", fontsize=font_size)
ax.legend(loc="center", fontsize=font_size)

```

### Results

<img src="https://github.com/berndab/pyber_analysis/blob/master/analysis/Table.Summary.png" width="760" height="225" />

<img src="https://github.com/berndab/pyber_analysis/blob/master/analysis/Chart.Weekly_Total_Fares.png" width="800" height="250" />
(Note the heading for the x-axis was omitted per the example in the chanllenge)

### Summary

The goal of this market analysis is to provide information to PyBer management so they can implement policies to improve access to ride sharing services and to improved affordability for underserved neighborhoods.


The data clearly shows that urban rides make up most of the rides provided by the PyBer. In addition, the data shows that the number of rides decrease and the average cost of a ride increases significantly as the ride location goes from an urban to a suburban to a rural setting. The rides decrease by 80% going from an urban to a suburban setting and by 97% when going from an urban to a rural setting. Furthermore, the average cost of a suburban ride is 25% higher and the average cost of a rural ride is 58% higher than an urban ride. Clearly, the data shows that the suburban and rural cities are PyBer's most underserved and least affordable regions.


It should be expected that the number of rides decreases the farther out the rides occur from major city centers. This decrease can be attributed to the smaller population density of suburban and rural cities and to these cities being more conducive to the use of personal automobiles for transportation. However, a 80% plus difference in total rides is too large a magnitude to be solely attributed to these two factors. The higher average cost of PyBer rides in suburban and rural setting must also strongly contribute to PyBer’s low ridership in these cities.

Transportation and parking cost should also be considered when explaining the ridership difference. The scarcity and cost of parking at urban destinations as opposed to the availability of free parking at the typical suburban and rural destination. also significantly contributes to this ridership difference. In urban settings, free parking is much less available, and the cost of paid parking is usually based on time. Depending on the urban destination and the time that a PyBer customer spends there, the parking costs in a significant number of instances would exceed the average cost of a urban PyBer ride. That means that PyBer is attractive to urban customers because, in many instances, it offers a cost saving over driving.


If we assume that the average distance to an urban destination is shorter than the average distance to a suburban or rural destination, the fuel cost of driving to an urban destination is negligible compared to the parking cost. These shorter distances keep the cost of using PyBer low for urban rides. Thus, the parking cost saving is the cost advantage of using PyBer in urban cities. However, for suburban and rural trips with the longer distances to destinations and the availability of ample free parking, there is a cost disadvantage to using PyBer. Because of free parking, it is usually cheaper to drive to suburban and rural destinations. However, the ride data provided does not include trip length, so there is no data available to test these assumptions.


To attract more riders in the underserved and more costly suburban and rural markets, PyBer must explore using a different cost model in these regions.  Given that currently the longer rides cost more and make driving the less expensive alternative for suburban and rural customers, PyBer must look at creating a graduated cost model. In the model, the per mile costs of a ride are reduced when a ride exceed and preset length threshold. For instance, all trip miles over 15 have a reduced rate per mile.  This would attract more riders in suburban and rural areas due to marginally lower costs.

### Technical Analyses Used

This analysis utilized the Pandas DataFrame functionality 

* `groupby()`
* `sum()`

to generate the summary data total values for rides, driver, and fares for the three city types

It also used the Pandas Series division operator '/'

* `result_series = numerator_series / demonimator_series

to generate the summary data average fare values per ride and per driver.

The graph of total weekly fares per city type was generated by using the Pandas pivot table functionality

* `pivot_df = pandas.pivot_table(source_data_df, values='Field1', index=['FieldX'],  columns=['Field2'])`

and the plotting functionality of the Pandas' DataFrame

* `df.plot()`


## Challenges Encountered and Overcome

### Challenges and Difficulties Encountered

The total driver count per city type data was supposed to be generated from the merged data frame per the challenge instructions. However, the merged data frame had duplicate city total number of drivers information

Each row in the merged data frame contains these data fields:
* City - the name that the ride occurred in
* Date - the ride occurred on
* Fare - the total paid by the customer for the ride
* City Type – the type of the city the ride occurred in
* No. Drivers - the total number of drivers in the 'City' the ride took place in. 

The value for the No. Drivers field is the same for ride rows that occurred in the same city. To use the merged data frame to get the number of drivers per city type, the data frame would have to be filtered to create a new data frame with unique values of the following columns:
* City
* City Type
* No. Drivers

Then the following methods would have to be called on this data frame

The method

* `df.grouped('City Type')`

and the method

* `df.sum()`

to get the total number of drivers per city type.

But the data frame created from the city_data.cvs file already contains this data!  It is highly inefficient to expend CPU resources to create a unique frame from a much larger merged data frame when the data already exists!!!  To maintain the efficiency of the analysis code, the total drivers per city type information was generated from the existing data frame containing data from the city_data.cvs file. 

* `city_data_df.groupby(["City Type"])["No. Drivers"].sum()`

## Recommendations and Next Steps

### Recommendations for Future Analysis

### Additional Analysis 1

All future individual ride data provided for analysis should contain ride distances. The average ride distance per city type values then could be used to validate the assumption that higher average trip costs in the suburban and rural cities are due to longer averages ride distances for these city types. The data then can be used to model different graduated fee structures for rides of longer distances to make using PyBer more cost effective and attractive to suburban and rural customers.

The average length of a ride by city type can be generated from ride data that contains ride length values by first getting the total distance of all the rides for a city type

* `per_city_type_total_ride distance = pyber_data_df.groupby(["City Type"])["Ride Length"].sum()`

then divide the total ride length per city type by the total number of rides per city type 

* `per_city_type_avg_ride_lenght = per_city_type_total_ride distance / per_city_type_total_rides`

### Additional Analysis 2

The PyBer client app should be updated to give the customer a list of reason to check as to why they chose to use PyBer for this trip instead of driving themselves. This will allow the data science team to get more detail information about the reasons the urban, suburban, and rural customers choose to use PyBer. Is the main reason that urban customers use PyBer cost savings? Is the main reason that suburban customers use PyBer convenience? Understanding the distribution of reasons suburban and rural customers use PyBer will enable PyBer management to develop additional strategies to make PyBer more affordable and attractive to use in the underserved and less cost effective cities.

Three data sets can be generated from ride data that contains trip reason information, one for each city type.

For each city type, a count of each reason can be generated

* `city_type_suburban_ride_reasons_cnt_df = city_type_suburban_ride_reasons_df.groupby(["Reson"]).count()`

Then a bar chart can be made from the reason count distribution data frame for a city type

* `city_type_suburban_ride_reasons_cnt_df.plot(type='bar')`
